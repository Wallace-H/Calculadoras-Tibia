<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tibia Spell Damage Calculator</title>

<style>
:root {
    --color-bg-base: #0f172a;
    --color-bg-surface: #1e293b;
    --color-text-primary: #f1f5f9;
    --color-text-secondary: #cbd5e1;
    --color-primary: #38bdf8;
    --color-primary-hover: #0284c7;
    --color-accent: #06b6d4;
}

* { margin:0; padding:0; box-sizing:border-box; }

body {
    font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;
    background:linear-gradient(135deg,#0f172a 0%,#1a1f35 100%);
    color:var(--color-text-primary);
    padding:20px;
    min-height:100vh;
}

.container { max-width:900px; margin:0 auto; }

.header { text-align:center; margin-bottom:40px; }

.header h1 {
    font-size: 2.5rem;
    margin-bottom: 10px;
    background: linear-gradient(135deg, #38bdf8, #06b6d4);
    background-clip: text;
    -webkit-background-clip: text;
    color: transparent;
}

.header p {
    color:var(--color-text-secondary);
    font-size:1.1rem;
}

.content {
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:30px;
    margin-bottom:30px;
}

.card {
    background:var(--color-bg-surface);
    border:1px solid rgba(56,189,248,0.2);
    border-radius:12px;
    padding:24px;
}

.card-title {
    font-size:1.3rem;
    margin-bottom:20px;
    color:var(--color-primary);
    font-weight:600;
}

.form-group { margin-bottom:20px; }

label {
    display:block;
    margin-bottom:8px;
    font-weight:500;
    color:var(--color-text-secondary);
}

select,input {
    width:100%;
    padding:12px;
    background:#0f172a;
    border:2px solid rgba(56,189,248,0.3);
    border-radius:8px;
    color:var(--color-text-primary);
    font-size:1rem;
}

select:focus,input:focus {
    outline:none;
    border-color:var(--color-primary);
}

.btn {
    width:100%;
    padding:14px;
    background:linear-gradient(135deg,#38bdf8,#06b6d4);
    border:none;
    border-radius:8px;
    color:white;
    font-weight:600;
    cursor:pointer;
}

.results {
    background:var(--color-bg-surface);
    border:2px solid rgba(6,182,212,0.3);
    border-radius:12px;
    padding:24px;
    margin-top:20px;
}

.result-item {
    display:flex;
    gap:15px;
    margin-bottom:15px;
    padding-bottom:15px;
    border-bottom:1px solid rgba(56,189,248,0.1);
}

.result-item:last-child {
    border-bottom:none;
    margin-bottom:0;
    padding-bottom:0;
}

.result-spell-icon {
    width:50px;
    height:50px;
    border-radius:8px;
    background:rgba(56,189,248,0.1);
    display:flex;
    align-items:center;
    justify-content:center;
    overflow:hidden;
}

.result-spell-icon img {
    width:100%;
    height:100%;
    object-fit:cover;
}

.result-content { flex:1; }

.result-spell-name {
    font-weight:600;
    color:var(--color-primary);
    margin-bottom:4px;
}

.result-damage {
    font-size:1.1rem;
    font-weight:700;
}

.damage-breakdown {
    font-size:0.85rem;
    color:var(--color-accent);
    margin-top:6px;
}

.stage-info {
    font-size:0.8rem;
    color:var(--color-accent);
}

@media (max-width:768px){
    .content{grid-template-columns:1fr;}
}
</style>
</head>

<body>

<div class="container">
<div class="header">
<h1>‚öîÔ∏è Tibia Spell Damage Calculator</h1>
<p>Calcule o dano das suas spells favoritas</p>
</div>

<div class="content">

<div class="card">
<div class="card-title">Configura√ß√µes</div>

<div class="form-group">
<label for="vocation">Selecione a Voca√ß√£o:</label>
<select id="vocation" onchange="updateSpells()">
<option value="">-- Escolha uma voca√ß√£o --</option>
<option value="sorcerer">Master Sorcerer</option>
<option value="druid">Elder Druid</option>
<option value="paladin">Royal Paladin</option>
</select>
</div>

<div class="form-group">
<label for="spell">Selecione a Spell:</label>
<select id="spell" onchange="updateSpellPreview()">
<option value="">-- Selecione uma voca√ß√£o primeiro --</option>
</select>
</div>

<div id="spellPreview" style="display:none;">
<div class="spell-icon placeholder" id="spellIconPreview">üìú</div>
</div>

<div class="form-group">
<label for="magic">Magic Level:</label>
<input type="number" id="magic" value="0" min="0">
</div>

<div class="form-group">
<label for="levelDmg">Level DMG Bonus:</label>
<input type="number" id="levelDmg" value="0" min="0">
</div>

<div class="form-group">
<label for="boost">B√¥nus % (Roda, Profici√™ncia, etc):</label>
<input type="number" id="boost" value="0" min="0" step="0.5">
</div>

<button class="btn" onclick="calculateDamage()">Calcular Dano</button>
</div>

<div class="card">
<div class="card-title">Resultados</div>
<div id="results" class="results">
Selecione uma spell e clique em calcular.
</div>
</div>

</div>
</div>

<script>

const spellsByVocation = {
            sorcerer: [
                { name: 'Great Fire Wave', basePower: 100, imageUrl: 'https://www.tibiawiki.com.br/images/1/1d/Great_Fire_Wave.gif' },
                { name: 'Energy Wave', basePower: 150, imageUrl: 'https://www.tibiawiki.com.br/images/7/7d/Energy_Wave.gif' },
                { name: 'Great Energy Beam', basePower: 170, imageUrl: 'https://www.tibiawiki.com.br/images/6/67/Great_Energy_Beam.gif' },
                { name: 'Rage of the Skies', basePower: 200, imageUrl: 'https://www.tibiawiki.com.br/images/9/9e/Rage_of_the_Skies.gif' },
                { name: "Hell's Core", basePower: 250, imageUrl: 'https://www.tibiawiki.com.br/images/0/0e/Hell%27s_Core.gif' }
            ],
            paladin: [
                { name: 'Divine Caldera', basePower: 140, imageUrl: 'https://www.tibiawiki.com.br/images/f/fa/Divine_Caldera.gif' },
                { name: 'Divine Grenade', basePower: 190, imageUrl: 'https://www.tibiawiki.com.br/images/b/be/Divine_Grenade.gif' }
            ],
            druid: [
                { name: 'Terra Wave', basePower: 120, imageUrl: 'https://www.tibiawiki.com.br/images/e/eb/Terra_Wave.gif' },
                { name: 'Strong Ice Wave', basePower: 150, imageUrl: 'https://www.tibiawiki.com.br/images/a/ae/Strong_Ice_Wave.gif' },
                { name: 'Wrath of Nature', basePower: 150, imageUrl: 'https://www.tibiawiki.com.br/images/a/ab/Wrath_of_Nature.gif' },
                { name: 'Eternal Winter', basePower: 200, imageUrl: 'https://www.tibiawiki.com.br/images/6/6e/Eternal_Winter.gif' },
                { name: 'Twin Bursts', basePower: 115, imageUrl: 'https://www.tibiawiki.com.br/images/0/0d/Twin_Bursts.gif', stages: [20, 40, 60] }
            ],
            monk: [],
            knight: []
        };

function updateSpells(){
const vocation=document.getElementById('vocation').value;
const spellSelect=document.getElementById('spell');
spellSelect.innerHTML='<option value="">-- Selecione uma spell --</option>';
if(!vocation)return;

spellsByVocation[vocation].forEach((spell,index)=>{
const opt=document.createElement('option');
opt.value=index;
opt.textContent=spell.name;
spellSelect.appendChild(opt);
});
}

function updateSpellPreview(){
const vocation=document.getElementById('vocation').value;
const spellIndex=document.getElementById('spell').value;
const preview=document.getElementById('spellPreview');
const icon=document.getElementById('spellIconPreview');

if(vocation && spellIndex!==""){
preview.style.display="block";
const spell=spellsByVocation[vocation][spellIndex];
icon.innerHTML=spell.imageUrl.trim()
? `<img src="${spell.imageUrl}" alt="${spell.name}">`
: 'üìú';
}else{
preview.style.display="none";
}
}

function calculateDamage(){

const vocation=document.getElementById('vocation').value;
const spellIndex=document.getElementById('spell').value;
const ml=parseFloat(document.getElementById('magic').value)||0;
const levelDmg=parseFloat(document.getElementById('levelDmg').value)||0;
const boost=parseFloat(document.getElementById('boost').value)||0;

if(!vocation||spellIndex===""){
alert("Selecione voca√ß√£o e spell.");
return;
}

const spell=spellsByVocation[vocation][spellIndex];
const results=document.getElementById('results');

const basePowerComBonus=spell.basePower*(1+boost/100);

function formula(bp){
return (ml*bp/25 + bp/4) + levelDmg;
}

let html=`<div class="result-item">
<div class="result-spell-icon">
${spell.imageUrl.trim()?`<img src="${spell.imageUrl}">`:'üìú'}
</div>
<div class="result-content">
<div class="result-spell-name">${spell.name}</div>`;

if (spell.stages) {

    // Valor base igual a qualquer outra spell (j√° com b√¥nus % aplicado)
    const baseNormalBonus = Math.floor(formula(basePowerComBonus));
    const baseNormalSemBonus = Math.floor(formula(spell.basePower));

    html += `<div>Base: <strong>${baseNormalBonus}</strong></div>`;

    spell.stages.forEach((stage) => {

        // Aplica % de est√°gio SOBRE o valor final j√° calculado
        const stageBonusValue = Math.floor(baseNormalBonus * (1 + stage / 100));
        const stageNormalValue = Math.floor(baseNormalSemBonus * (1 + stage / 100));

        const diferencaStage = stageBonusValue - stageNormalValue;

        html += `
            <div>Base +${stage}%: <strong>${stageBonusValue}</strong></div>
            ${boost > 0 ? `<div class="damage-breakdown">Aumentou ${diferencaStage} com ${boost}% de b√¥nus</div>` : ''}
        `;
    });

    html += `<div class="stage-info">Est√°gios independentes (n√£o acumulativos)</div>`;
}else{

const danoBonus=Math.floor(formula(basePowerComBonus));
const danoNormal=Math.floor(formula(spell.basePower));
const diferenca=danoBonus-danoNormal;

html+=`<div class="result-damage">${danoBonus} de dano</div>
${boost>0?`<div class="damage-breakdown">Aumentou ${Math.floor(diferenca)} com ${boost}% de b√¥nus</div>`:''}`;
}

html+=`</div></div>`;
results.innerHTML=html;
}

</script>
</body>
</html>
